var myApp=angular.module("myApp","fileUpload",["ngRoute"],["ngFileUpload"]);myApp.config(["$routeProvider","$locationProvider",function(a,b){b.hashPrefix(""),a.when("/home",{templateUrl:"/views/templates/home.html",controller:"LoginController"}).when("/register",{templateUrl:"/views/templates/register.html",controller:"LoginController"}).when("/user",{templateUrl:"/views/templates/user.html",controller:"UserController",resolve:{getuser:["UserService",function(a){return a.getuser()}]}}).when("/info",{templateUrl:"/views/templates/info.html",controller:"InfoController",resolve:{getuser:["UserService",function(a){return a.getuser()}]}}).when("/recipe",{templateUrl:"/views/templates/recipe.html",controller:"RecipeController",resolve:{getuser:["UserService",function(a){return a.getuser()}]}}).when("/detail",{templateUrl:"/views/templates/detail.html",controller:"DetailController",resolve:{getuser:["UserService",function(a){return a.getuser()}]}}).when("/detail/:id",{templateUrl:"/views/templates/detail.html",controller:"DetailController",resolve:{getuser:["UserService",function(a){return a.getuser()}]}}).when("/activate/:code",{templateUrl:"/views/templates/activate.html",controller:"ActivateController",resolve:{getuser:["UserService",function(a){return a.getuser()}]}}).otherwise({redirectTo:"home"})}]),myApp.controller("ActivateController",["$scope","$http","$location","$routeParams","UserService",function(a,b,c,d,e){a.logout=e.logout,a.code=e.code,void 0!=d.code&&(a.code.tempCode=d.code),console.log("ActivateController loaded",a.code.tempCode)}]),myApp.controller("DetailController",["$scope","$http","$location","$routeParams","UserService",function(a,b,c,d,e){console.log("DetailController"),a.recipeID=e.recipeID,e.findRecipeID(d.id),a.saveRecipe=e.saveRecipe,a.removeRecipeID=function(a){swal({title:"Are you sure you want to delete recipe?",showCancelButton:!0,confirmButtonColor:"#592941",confirmButtonText:"Delete!",closeOnConfirm:!1},function(){swal("Deleted!","Your recipe has been deleted.","success"),e.removeRecipeID(a)})}}]),myApp.controller("FavoriteController",["$scope","$http","$location","$routeParams","UserService",function(a,b,c,d,e){console.log("FavoriteController")}]),myApp.controller("InfoController",["$scope","$http","$location","UserService",function(a,b,c,d){a.logout=d.logout,a.sushiList={},a.getRecipes=function(){b.get("/recipe").then(function(b){console.log("InfoController",b),a.sushiList.recipes=b.data})},a.getRecipes()}]),myApp.controller("LoginController",["$scope","$http","$location","UserService",function(a,b,c,d){a.user={username:"",password:""},a.message="",a.login=function(){""===a.user.username||""===a.user.password?a.message="Enter your username and password!":(console.log("sending to server...",a.user),b.post("/",a.user).then(function(b){b.data.username?(console.log("success: ",b.data),c.path("/user")):(console.log("failure: ",b),a.message="Wrong!!")}))},a.registerUser=function(){""===a.user.username||""===a.user.password?a.message="Choose a username and password!":(console.log("sending to server...",a.user),b.post("/register",a.user).then(function(a){console.log("success"),c.path("/user")},function(b){console.log("error"),a.message="Please try again."}))}}]),myApp.controller("RecipeController",["$scope","$http","$location","UserService",function(a,b,c,d){a.newRecipe={name:"",description:"",ingredients:""},a.postRecipe=function(a){console.log(a),b.post("/recipe",a).then(function(a){console.log("HERE: ",a),c.url("/info")})},a.newRecipeID={name:"",description:"",ingredients:""},a.postRecipeID=function(a){console.log(a),b.post("/recipe",a).then(function(a){c.url("/detail")})}}]),myApp.controller("UserController",["$scope","$http","$location","UserService",function(a,b,c,d){a.userObject=d.userObject,a.logout=d.logout}]),myApp.factory("UserService",["$http","$location",function(a,b){console.log("User Service Loaded");var c={},d={};return{userObject:c,recipeID:d,getuser:function(){a.get("/user").then(function(a){a.data.username?(c.userName=a.data.username,console.log("User Data: ",c.userName)):b.path("/home")})},findRecipeID:function(b){a.get("/recipe/"+b).then(function(a){d.recipe=a.data,console.log("RecipeID Data: ",d.recipe)})},removeRecipeID:function(c){console.log("Delete",c),a.delete("/recipe/delete/"+c).then(function(a){console.log("RecipeID Data: ",a.data),b.path("/info")})},saveRecipe:function(b){a.put("/recipe/edit",b).then(function(a){console.log("RecipeID Data: ",b)})},logout:function(){a.get("/user/logout").then(function(a){console.log("logged out"),b.path("/home")})}}}]);